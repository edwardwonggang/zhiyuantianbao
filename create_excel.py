#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import pandas as pd
from openpyxl import Workbook
from openpyxl.styles import Font, Alignment, PatternFill
from openpyxl.utils.dataframe import dataframe_to_rows

def create_hubei_score_excel():
    """创建湖北省理科一分一段表Excel文件"""
    
    # 创建工作簿
    wb = Workbook()
    
    # 删除默认工作表
    wb.remove(wb.active)
    
    # 2024年数据
    data_2024 = [
        ["分数", "人数", "累计人数"],
        ["695-750", 44, 44],
        ["694", 6, 50],
        ["693", 10, 60],
        ["692", 11, 71],
        ["691", 12, 83],
        ["690", 15, 98],
        ["689", 17, 115],
        ["688", 13, 128],
        ["687", 9, 137],
        ["686", 22, 159],
        ["685", 14, 173],
        ["684", 14, 187],
        ["683", 21, 208],
        ["682", 31, 239],
        ["681", 32, 271],
        ["680", 29, 300],
        ["679", 32, 332],
        ["678", 40, 372],
        ["677", 40, 412],
        ["676", 34, 446],
        ["675", 42, 488],
        ["674", 38, 526],
        ["673", 55, 581],
        ["672", 37, 618],
        ["671", 53, 671],
        ["670", 55, 726],
        ["669", 62, 788],
        ["668", 54, 842],
        ["667", 56, 898],
        ["666", 65, 963],
        ["665", 83, 1046],
        ["664", 90, 1136],
        ["663", 105, 1241],
        ["662", 73, 1314],
        ["661", 102, 1416],
        ["660", 91, 1507],
        ["659", 96, 1603],
        ["658", 116, 1719],
        ["657", 128, 1847],
        ["656", 124, 1971],
        ["655", 109, 2080],
        ["654", 113, 2193],
        ["653", 122, 2315],
        ["652", 138, 2453],
        ["651", 143, 2596],
        ["650", 131, 2727],
        ["649", 152, 2879],
        ["648", 154, 3033],
        ["647", 185, 3218],
        ["646", 144, 3362],
        ["645", 170, 3532],
        ["644", 180, 3712],
        ["643", 189, 3901],
        ["642", 184, 4085],
        ["641", 202, 4287],
        ["640", 208, 4495],
        ["639", 215, 4710],
        ["638", 180, 4890],
        ["637", 209, 5099],
        ["636", 227, 5326],
        ["635", 217, 5543],
        ["634", 213, 5756],
        ["633", 226, 5982],
        ["632", 261, 6243],
        ["631", 266, 6509],
        ["630", 268, 6777],
        ["629", 279, 7056],
        ["628", 300, 7356],
        ["627", 303, 7659],
        ["626", 251, 7910],
        ["625", 305, 8215],
        ["624", 271, 8486],
        ["623", 274, 8760],
        ["622", 307, 9067],
        ["621", 290, 9357],
        ["620", 344, 9701],
        ["619", 334, 10035],
        ["618", 337, 10372],
        ["617", 308, 10680],
        ["616", 378, 11058],
        ["615", 337, 11395],
        ["614", 361, 11756],
        ["613", 402, 12158],
        ["612", 378, 12536],
        ["611", 396, 12932],
        ["610", 383, 13315],
        ["609", 413, 13728],
        ["608", 388, 14116],
        ["607", 403, 14519],
        ["606", 415, 14934],
        ["605", 422, 15356],
        ["604", 412, 15768],
        ["603", 462, 16230],
        ["602", 455, 16685],
        ["601", 454, 17139],
        ["600", 474, 17613],
        ["599", 471, 18084],
        ["598", 479, 18563],
        ["597", 500, 19063],
        ["596", 474, 19537],
        ["595", 468, 20005],
        ["594", 488, 20493],
        ["593", 493, 20986],
        ["592", 525, 21511],
        ["591", 486, 21997],
        ["590", 476, 22473],
        ["589", 598, 23071],
        ["588", 525, 23596],
        ["587", 536, 24132],
        ["586", 549, 24681],
        ["585", 543, 25224],
        ["584", 568, 25792],
        ["583", 600, 26392],
        ["582", 599, 26991],
        ["581", 600, 27591],
        ["580", 641, 28232],
        ["579", 669, 28901],
        ["578", 561, 29462],
        ["577", 618, 30080],
        ["576", 633, 30713],
        ["575", 638, 31351],
        ["574", 618, 31969],
        ["573", 644, 32613],
        ["572", 656, 33269],
        ["571", 688, 33957],
        ["570", 664, 34621],
        ["569", 685, 35306],
        ["568", 672, 35978],
        ["567", 681, 36659],
        ["566", 660, 37319],
        ["565", 688, 38007],
        ["564", 672, 38679],
        ["563", 669, 39348],
        ["562", 694, 40042],
        ["561", 671, 40713],
        ["560", 725, 41438],
        ["559", 698, 42136],
        ["558", 719, 42855],
        ["557", 762, 43617],
        ["556", 709, 44326],
        ["555", 725, 45051],
        ["554", 790, 45841],
        ["553", 697, 46538],
        ["552", 744, 47282],
        ["551", 737, 48019],
        ["550", 789, 48808],
        ["549", 730, 49538],
        ["548", 757, 50295],
        ["547", 749, 51044],
        ["546", 790, 51834],
        ["545", 694, 52528],
        ["544", 730, 53258],
        ["543", 797, 54055],
        ["542", 782, 54837],
        ["541", 839, 55676],
        ["540", 823, 56499],
        ["539", 757, 57256],
        ["538", 795, 58051],
        ["537", 821, 58872],
        ["536", 844, 59716],
        ["535", 772, 60488],
        ["534", 804, 61292],
        ["533", 801, 62093],
        ["532", 811, 62904],
        ["531", 791, 63695],
        ["530", 781, 64476],
        ["529", 884, 65360],
        ["528", 838, 66198],
        ["527", 843, 67041],
        ["526", 821, 67862],
        ["525", 816, 68678],
        ["524", 825, 69503],
        ["523", 759, 70262],
        ["522", 846, 71108],
        ["521", 834, 71942],
        ["520", 844, 72786],
        ["519", 822, 73608],
        ["518", 825, 74433],
        ["517", 843, 75276],
        ["516", 769, 76045],
        ["515", 829, 76874],
        ["514", 828, 77702],
        ["513", 855, 78557],
        ["512", 843, 79400],
        ["511", 809, 80209],
        ["510", 837, 81046],
        ["509", 842, 81888],
        ["508", 864, 82752],
        ["507", 876, 83628],
        ["506", 837, 84465],
        ["505", 865, 85330],
        ["504", 851, 86181],
        ["503", 809, 86990],
        ["502", 851, 87841],
        ["501", 826, 88667],
        ["500", 834, 89501],
        ["499", 811, 90312],
        ["498", 800, 91112],
        ["497", 853, 91965],
        ["496", 785, 92750],
        ["495", 867, 93617],
        ["494", 821, 94438],
        ["493", 807, 95245],
        ["492", 790, 96035],
        ["491", 826, 96861],
        ["490", 859, 97720],
        ["489", 823, 98543],
        ["488", 877, 99420],
        ["487", 770, 100190],
        ["486", 851, 101041],
        ["485", 853, 101894],
        ["484", 828, 102722],
        ["483", 888, 103610],
        ["482", 819, 104429],
        ["481", 856, 105285],
        ["480", 812, 106097],
        ["479", 856, 106953],
        ["478", 814, 107767],
        ["477", 803, 108570],
        ["476", 814, 109384],
        ["475", 845, 110229],
        ["474", 852, 111081],
        ["473", 796, 111877],
        ["472", 783, 112660],
        ["471", 833, 113493],
        ["470", 833, 114326],
        ["469", 748, 115074],
        ["468", 826, 115900],
        ["467", 809, 116709],
        ["466", 850, 117559],
        ["465", 817, 118376],
        ["464", 797, 119173],
        ["463", 782, 119955],
        ["462", 744, 120699],
        ["461", 865, 121564],
        ["460", 791, 122355],
        ["459", 817, 123172],
        ["458", 795, 123967],
        ["457", 753, 124720],
        ["456", 764, 125484],
        ["455", 804, 126288],
        ["454", 780, 127068],
        ["453", 826, 127894],
        ["452", 745, 128639],
        ["451", 785, 129424],
        ["450", 790, 130214]
    ]
    
    # 创建2024年工作表
    ws_2024 = wb.create_sheet("2024年湖北理科一分一段")
    
    # 添加标题
    ws_2024.append(["湖北省2024年普通高考总分一分一段统计表（物理类）"])
    ws_2024.merge_cells('A1:C1')
    
    # 设置标题样式
    title_cell = ws_2024['A1']
    title_cell.font = Font(size=14, bold=True)
    title_cell.alignment = Alignment(horizontal='center')
    title_cell.fill = PatternFill(start_color="CCCCCC", end_color="CCCCCC", fill_type="solid")
    
    # 添加空行
    ws_2024.append([])
    
    # 添加数据
    for row in data_2024:
        ws_2024.append(row)
    
    # 设置表头样式
    header_row = 3
    for col in range(1, 4):
        cell = ws_2024.cell(row=header_row, column=col)
        cell.font = Font(bold=True)
        cell.alignment = Alignment(horizontal='center')
        cell.fill = PatternFill(start_color="E6E6E6", end_color="E6E6E6", fill_type="solid")
    
    # 设置列宽
    ws_2024.column_dimensions['A'].width = 15
    ws_2024.column_dimensions['B'].width = 12
    ws_2024.column_dimensions['C'].width = 15
    
    # 创建2023年和2022年的空工作表（稍后填充）
    ws_2023 = wb.create_sheet("2023年湖北理科一分一段")
    ws_2022 = wb.create_sheet("2022年湖北理科一分一段")
    
    # 为2023年和2022年添加基本结构
    for ws, year in [(ws_2023, "2023"), (ws_2022, "2022")]:
        ws.append([f"湖北省{year}年普通高考总分一分一段统计表（物理类）"])
        ws.merge_cells('A1:C1')
        title_cell = ws['A1']
        title_cell.font = Font(size=14, bold=True)
        title_cell.alignment = Alignment(horizontal='center')
        title_cell.fill = PatternFill(start_color="CCCCCC", end_color="CCCCCC", fill_type="solid")
        
        ws.append([])
        ws.append(["分数", "人数", "累计人数"])
        
        # 设置表头样式
        for col in range(1, 4):
            cell = ws.cell(row=3, column=col)
            cell.font = Font(bold=True)
            cell.alignment = Alignment(horizontal='center')
            cell.fill = PatternFill(start_color="E6E6E6", end_color="E6E6E6", fill_type="solid")
        
        # 设置列宽
        ws.column_dimensions['A'].width = 15
        ws.column_dimensions['B'].width = 12
        ws.column_dimensions['C'].width = 15
        
        # 添加提示信息
        ws.append(["数据待补充...", "", ""])
    
    # 保存文件
    wb.save("湖北省理科一分一段表2022-2024.xlsx")
    print("Excel文件已创建：湖北省理科一分一段表2022-2024.xlsx")
    print("2024年数据已填充完成")
    print("2023年和2022年数据结构已创建，等待数据填充")

if __name__ == "__main__":
    create_hubei_score_excel()
