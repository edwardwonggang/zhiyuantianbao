#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import pandas as pd
from openpyxl import load_workbook
from openpyxl.styles import Font, Alignment, PatternFill

def update_2023_data():
    """更新2023年湖北理科一分一段表数据"""
    
    # 2023年数据
    data_2023 = [
        ["697-750", 45, 45],
        ["696", 5, 50],
        ["695", 13, 63],
        ["694", 11, 74],
        ["693", 11, 85],
        ["692", 12, 97],
        ["691", 11, 108],
        ["690", 11, 119],
        ["689", 17, 136],
        ["688", 20, 156],
        ["687", 21, 177],
        ["686", 21, 198],
        ["685", 18, 216],
        ["684", 24, 240],
        ["683", 38, 278],
        ["682", 27, 305],
        ["681", 34, 339],
        ["680", 38, 377],
        ["679", 37, 414],
        ["678", 45, 459],
        ["677", 45, 504],
        ["676", 43, 547],
        ["675", 51, 598],
        ["674", 60, 658],
        ["673", 76, 734],
        ["672", 76, 810],
        ["671", 93, 903],
        ["670", 76, 979],
        ["669", 84, 1063],
        ["668", 84, 1147],
        ["667", 86, 1233],
        ["666", 77, 1310],
        ["665", 86, 1396],
        ["664", 128, 1524],
        ["663", 105, 1629],
        ["662", 132, 1761],
        ["661", 130, 1891],
        ["660", 105, 1996],
        ["659", 112, 2108],
        ["658", 135, 2243],
        ["657", 134, 2377],
        ["656", 148, 2525],
        ["655", 158, 2683],
        ["654", 171, 2854],
        ["653", 130, 2984],
        ["652", 176, 3160],
        ["651", 191, 3351],
        ["650", 177, 3528],
        ["649", 177, 3705],
        ["648", 196, 3901],
        ["647", 174, 4075],
        ["646", 180, 4255],
        ["645", 220, 4475],
        ["644", 207, 4682],
        ["643", 239, 4921],
        ["642", 213, 5134],
        ["641", 233, 5367],
        ["640", 241, 5608],
        ["639", 206, 5814],
        ["638", 259, 6073],
        ["637", 232, 6305],
        ["636", 239, 6544],
        ["635", 273, 6817],
        ["634", 264, 7081],
        ["633", 276, 7357],
        ["632", 278, 7635],
        ["631", 274, 7909],
        ["630", 279, 8188],
        ["629", 306, 8494],
        ["628", 318, 8812],
        ["627", 314, 9126],
        ["626", 310, 9436],
        ["625", 295, 9731],
        ["624", 347, 10078],
        ["623", 325, 10403],
        ["622", 335, 10738],
        ["621", 326, 11064],
        ["620", 333, 11397],
        ["619", 328, 11725],
        ["618", 352, 12077],
        ["617", 334, 12411],
        ["616", 372, 12783],
        ["615", 408, 13191],
        ["614", 374, 13565],
        ["613", 369, 13934],
        ["612", 382, 14316],
        ["611", 370, 14686],
        ["610", 398, 15084],
        ["609", 385, 15469],
        ["608", 422, 15891],
        ["607", 424, 16315],
        ["606", 441, 16756],
        ["605", 375, 17131],
        ["604", 426, 17557],
        ["603", 461, 18018],
        ["602", 455, 18473],
        ["601", 418, 18891],
        ["600", 437, 19328],
        ["599", 452, 19780],
        ["598", 435, 20215],
        ["597", 457, 20672],
        ["596", 435, 21107],
        ["595", 463, 21570],
        ["594", 465, 22035],
        ["593", 492, 22527],
        ["592", 483, 23010],
        ["591", 480, 23490],
        ["590", 494, 23984],
        ["589", 447, 24431],
        ["588", 455, 24886],
        ["587", 492, 25378],
        ["586", 533, 25911],
        ["585", 496, 26407],
        ["584", 528, 26935],
        ["583", 545, 27480],
        ["582", 511, 27991],
        ["581", 541, 28532],
        ["580", 534, 29066],
        ["579", 496, 29562],
        ["578", 534, 30096],
        ["577", 537, 30633],
        ["576", 541, 31174],
        ["575", 525, 31699],
        ["574", 533, 32232],
        ["573", 562, 32794],
        ["572", 517, 33311],
        ["571", 561, 33872],
        ["570", 586, 34458],
        ["569", 562, 35020],
        ["568", 573, 35593],
        ["567", 559, 36152],
        ["566", 581, 36733],
        ["565", 577, 37310],
        ["564", 611, 37921],
        ["563", 622, 38543],
        ["562", 559, 39102],
        ["561", 610, 39712],
        ["560", 604, 40316],
        ["559", 575, 40891],
        ["558", 615, 41506],
        ["557", 647, 42153],
        ["556", 597, 42750],
        ["555", 676, 43426],
        ["554", 645, 44071],
        ["553", 610, 44681],
        ["552", 598, 45279],
        ["551", 607, 45886],
        ["550", 641, 46527],
        ["549", 664, 47191],
        ["548", 574, 47765],
        ["547", 666, 48431],
        ["546", 670, 49101],
        ["545", 635, 49736],
        ["544", 632, 50368],
        ["543", 670, 51038],
        ["542", 649, 51687],
        ["541", 588, 52275],
        ["540", 612, 52887],
        ["539", 638, 53525],
        ["538", 655, 54180],
        ["537", 636, 54816],
        ["536", 676, 55492],
        ["535", 648, 56140],
        ["534", 681, 56821],
        ["533", 678, 57499],
        ["532", 653, 58152],
        ["531", 653, 58805],
        ["530", 646, 59451],
        ["529", 671, 60122],
        ["528", 637, 60759],
        ["527", 637, 61396],
        ["526", 695, 62091],
        ["525", 707, 62798],
        ["524", 636, 63434],
        ["523", 711, 64145],
        ["522", 693, 64838],
        ["521", 645, 65483],
        ["520", 704, 66187],
        ["519", 678, 66865],
        ["518", 648, 67513],
        ["517", 683, 68196],
        ["516", 629, 68825],
        ["515", 654, 69479],
        ["514", 665, 70144],
        ["513", 677, 70821],
        ["512", 685, 71506],
        ["511", 664, 72170],
        ["510", 660, 72830],
        ["509", 705, 73535],
        ["508", 634, 74169],
        ["507", 643, 74812],
        ["506", 665, 75477],
        ["505", 676, 76153],
        ["504", 685, 76838],
        ["503", 653, 77491],
        ["502", 661, 78152],
        ["501", 646, 78798],
        ["500", 658, 79456],
        ["499", 617, 80073],
        ["498", 649, 80722],
        ["497", 681, 81403],
        ["496", 661, 82064],
        ["495", 598, 82662],
        ["494", 670, 83332],
        ["493", 678, 84010],
        ["492", 687, 84697],
        ["491", 652, 85349],
        ["490", 649, 85998],
        ["489", 619, 86617],
        ["488", 652, 87269],
        ["487", 647, 87916],
        ["486", 660, 88576],
        ["485", 715, 89291],
        ["484", 679, 89970],
        ["483", 645, 90615],
        ["482", 620, 91235],
        ["481", 649, 91884],
        ["480", 687, 92571],
        ["479", 677, 93248],
        ["478", 638, 93886],
        ["477", 677, 94563],
        ["476", 686, 95249],
        ["475", 670, 95919],
        ["474", 668, 96587],
        ["473", 659, 97246],
        ["472", 627, 97873],
        ["471", 659, 98532],
        ["470", 625, 99157],
        ["469", 644, 99801],
        ["468", 668, 100469],
        ["467", 633, 101102],
        ["466", 698, 101800],
        ["465", 660, 102460],
        ["464", 708, 103168],
        ["463", 699, 103867],
        ["462", 647, 104514],
        ["461", 647, 105161],
        ["460", 684, 105845],
        ["459", 659, 106504],
        ["458", 635, 107139],
        ["457", 708, 107847],
        ["456", 690, 108537],
        ["455", 691, 109228],
        ["454", 651, 109879],
        ["453", 626, 110505],
        ["452", 681, 111186],
        ["451", 632, 111818],
        ["450", 681, 112499]
    ]
    
    # 加载现有的Excel文件
    wb = load_workbook("湖北省理科一分一段表2022-2024.xlsx")
    
    # 获取2023年工作表
    ws_2023 = wb["2023年湖北理科一分一段"]
    
    # 清除现有数据（保留标题和表头）
    for row in ws_2023.iter_rows(min_row=4, max_row=ws_2023.max_row):
        for cell in row:
            cell.value = None
    
    # 添加2023年数据
    for i, row_data in enumerate(data_2023, start=4):
        for j, value in enumerate(row_data, start=1):
            ws_2023.cell(row=i, column=j, value=value)
    
    # 设置数据格式
    for row in range(4, len(data_2023) + 4):
        for col in range(1, 4):
            cell = ws_2023.cell(row=row, column=col)
            cell.alignment = Alignment(horizontal='center')
    
    # 保存文件
    wb.save("湖北省理科一分一段表2022-2024.xlsx")
    print("2023年数据已成功添加到Excel文件中")
    print(f"共添加了 {len(data_2023)} 行数据")

if __name__ == "__main__":
    update_2023_data()
