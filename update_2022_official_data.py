#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import pandas as pd
from openpyxl import load_workbook
from openpyxl.styles import Font, Alignment, PatternFill

def update_2022_official_data():
    """使用官方准确数据更新2022年湖北理科一分一段表"""
    
    # 湖北省2022年普通高考总分一分一段统计表—普通类(首选物理)
    # 注:本表统计人数含政策性加分
    official_data_2022 = [
        ["分数", "人数", "累计人数"],
        ["683", 4, 50],
        ["682", 8, 58],
        ["681", 3, 61],
        ["680", 4, 65],
        ["679", 7, 72],
        ["678", 6, 78],
        ["677", 9, 87],
        ["676", 14, 101],
        ["675", 20, 121],
        ["674", 13, 134],
        ["673", 15, 149],
        ["672", 9, 158],
        ["671", 15, 173],
        ["670", 15, 188],
        ["669", 19, 207],
        ["668", 24, 231],
        ["667", 20, 251],
        ["666", 16, 267],
        ["665", 20, 287],
        ["664", 21, 308],
        ["663", 18, 326],
        ["662", 29, 355],
        ["661", 24, 379],
        ["660", 27, 406],
        ["659", 39, 445],
        ["658", 27, 472],
        ["657", 26, 498],
        ["656", 42, 540],
        ["655", 39, 579],
        ["654", 34, 613],
        ["653", 41, 654],
        ["652", 38, 693],
        ["651", 49, 742],
        ["650", 56, 798],
        ["649", 55, 853],
        ["648", 49, 902],
        ["647", 61, 963],
        ["646", 49, 1012],
        ["645", 67, 1079],
        ["644", 73, 1152],
        ["643", 73, 1225],
        ["642", 74, 1299],
        ["641", 80, 1379],
        ["640", 85, 1464],
        ["639", 79, 1543],
        ["638", 93, 1636],
        ["637", 92, 1728],
        ["636", 91, 1819],
        ["635", 101, 1920],
        ["634", 97, 2017],
        ["633", 101, 2118],
        ["632", 105, 2223],
        ["631", 107, 2330],
        ["630", 117, 2447],
        ["629", 118, 2565],
        ["628", 131, 2696],
        ["627", 141, 2837],
        ["626", 110, 2947],
        ["625", 120, 3067],
        ["624", 164, 3231],
        ["623", 156, 3387],  # 修正：原数据显示756，应该是156
        ["622", 146, 3533],
        ["621", 144, 3677],
        ["620", 148, 3825],
        ["619", 175, 4000],
        ["618", 142, 4142],
        ["617", 178, 4320],
        ["616", 173, 4493],
        ["615", 177, 4670],
        ["614", 182, 4852],
        ["613", 167, 5019],
        ["612", 203, 5222],
        ["611", 195, 5417],
        ["610", 223, 5640],
        ["609", 235, 5875],
        ["608", 221, 6096],
        ["607", 233, 6329],
        ["606", 217, 6546],
        ["605", 258, 6804],
        ["604", 285, 7089],
        ["603", 247, 7336],
        ["602", 241, 7577],
        ["601", 265, 7842],
        ["600", 244, 8086],
        ["599", 262, 8348],
        ["598", 297, 8645],
        ["597", 295, 8940],
        ["596", 278, 9218],
        ["595", 338, 9556],
        ["594", 300, 9856],
        ["593", 301, 10157],
        ["592", 279, 10436],
        ["591", 343, 10779],
        ["590", 349, 11128],
        ["589", 354, 11482],
        ["588", 363, 11845],
        ["587", 351, 12196],
        ["586", 348, 12544],
        ["585", 371, 12915],
        ["584", 380, 13295],
        ["583", 368, 13663],
        ["582", 398, 14061],
        ["581", 407, 14468],
        ["580", 385, 14853],
        ["579", 398, 15251],
        ["578", 407, 15658],
        ["577", 395, 16053],
        ["576", 446, 16499],
        ["575", 437, 16936],
        ["574", 436, 17372],
        ["573", 483, 17855],
        ["572", 438, 18293],
        ["571", 461, 18754],
        ["570", 454, 19208],
        ["569", 459, 19667],
        ["568", 484, 20151],
        ["567", 492, 20643],
        ["566", 492, 21135],
        ["565", 501, 21636],
        ["564", 519, 22155],
        ["563", 478, 22633],
        ["562", 532, 23165],
        ["561", 465, 23630],
        ["560", 546, 24176],
        ["559", 530, 24706],
        ["558", 533, 25239],
        ["557", 551, 25790],
        ["556", 533, 26323],
        ["555", 541, 26864],
        ["554", 575, 27439],
        ["553", 556, 27995]
    ]
    
    # 加载现有的Excel文件
    wb = load_workbook("湖北省理科一分一段表2022-2024.xlsx")
    
    # 获取2022年工作表
    ws_2022 = wb["2022年湖北理科一分一段"]
    
    # 清除现有数据（保留标题和表头）
    for row in ws_2022.iter_rows(min_row=4, max_row=ws_2022.max_row):
        for cell in row:
            cell.value = None
    
    # 添加2022年官方数据
    for i, row_data in enumerate(official_data_2022, start=4):
        for j, value in enumerate(row_data, start=1):
            cell = ws_2022.cell(row=i, column=j, value=value)
            cell.alignment = Alignment(horizontal='center')
            
            # 为表头设置样式
            if i == 4:  # 表头行
                cell.font = Font(bold=True)
                cell.fill = PatternFill(start_color="E6E6E6", end_color="E6E6E6", fill_type="solid")
    
    # 添加数据说明
    last_row = len(official_data_2022) + 6
    ws_2022.cell(row=last_row, column=1, value="数据说明：")
    ws_2022.cell(row=last_row + 1, column=1, value="1. 数据来源：湖北省教育考试院官方发布")
    ws_2022.cell(row=last_row + 2, column=1, value="2. 统计说明：本表统计人数含政策性加分")
    ws_2022.cell(row=last_row + 3, column=1, value="3. 分数范围：683分-553分")
    ws_2022.cell(row=last_row + 4, column=1, value="4. 2022年湖北省本科线：物理类409分")
    ws_2022.cell(row=last_row + 5, column=1, value="5. 2022年湖北省特殊类型招生控制线：物理类504分")
    
    # 保存文件
    wb.save("湖北省理科一分一段表2022-2024.xlsx")
    print("2022年官方数据已成功更新到Excel文件中")
    print(f"共添加了 {len(official_data_2022)} 行数据（包含表头）")
    print("数据范围：683分-553分，共131个分数段")
    print("数据来源：湖北省教育考试院官方发布")

if __name__ == "__main__":
    update_2022_official_data()
